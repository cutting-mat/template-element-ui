(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8b9d5c54"],{ff47:function(t,e,r){"use strict";r.r(e),r.d(e,"list",(function(){return o})),r.d(e,"detail",(function(){return n})),r.d(e,"add",(function(){return i})),r.d(e,"edit",(function(){return c})),r.d(e,"remove",(function(){return l}));var a=r("c7b2"),o=function(t){return a["d"].get("/role/s",{params:t})},n=function(t){return a["d"].get("/role",{params:t})},i=function(t){return a["d"].post("/role",t)},c=function(t){return a["d"].put("/role",t)},l=function(t){return a["d"].delete("/role",{params:t})}},ffb8:function(t,e,r){"use strict";r.r(e);var a={};r.r(a),r.d(a,"list",(function(){return c})),r.d(a,"detail",(function(){return l})),r.d(a,"add",(function(){return s})),r.d(a,"edit",(function(){return u})),r.d(a,"remove",(function(){return d})),r.d(a,"resetPassword",(function(){return m}));var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:t.loading,expression:"loading",modifiers:{fullscreen:!0}}],staticClass:"scrollbar blockLayout"},[r("div",{staticClass:"flex-row align-center toolBar"},[r("div",{staticClass:"flex-1"}),r("el-button",{directives:[{name:"auth",rawName:"v-auth",value:t.account.add,expression:"account.add"}],attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("添加")])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list}},[r("el-table-column",{attrs:{prop:"accountNumber",label:"账号",width:"150",align:"center"}}),r("el-table-column",{attrs:{prop:"accountName",label:"用户名",width:"150",align:"center"}}),r("el-table-column",{attrs:{label:"角色",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.roles,(function(e,a){return r("div",{key:a},[t._v(" "+t._s(e.orgName+" - "+e.roleName)+" ")])}))}}])}),r("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.state?[r("span",{staticStyle:{color:"#13ce66"}},[t._v("已启用")])]:[r("span",{staticStyle:{color:"#ff4949"}},[t._v("已禁用")])]]}}])}),r("el-table-column",{attrs:{label:"操作",width:"300",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{directives:[{name:"auth",rawName:"v-auth",value:t.account.edit,expression:"account.edit"}],attrs:{size:"mini"},on:{click:function(r){return t.edit(e.row)}}},[t._v("编辑")]),r("el-button",{directives:[{name:"auth",rawName:"v-auth",value:t.account.resetPassword,expression:"account.resetPassword"}],attrs:{size:"mini",type:"warning"},on:{click:function(r){return t.resetPassword(e.row)}}},[t._v("重置密码")]),r("el-button",{directives:[{name:"auth",rawName:"v-auth",value:t.account.remove,expression:"account.remove"}],attrs:{size:"mini",type:"danger"},on:{click:function(r){return t.remove(e.row)}}},[t._v("删除")])]}}])})],1),r("Pagination",{attrs:{"page-size":t.queryParam.pageSize,"current-page":t.queryParam.p,"total-count":t.totalCount,"total-page":t.totalPage},on:{"current-change":t.handleCurrentChange}}),r("el-dialog",{attrs:{"close-on-click-modal":!1,title:"账号信息",visible:t.dialogVisible,width:"800px"},on:{close:t.handleCloseDialog}},[r("el-form",{ref:"editForm",attrs:{size:"small",rules:t.rules,model:t.editForm,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"账号",prop:"accountNumber"}},[r("el-input",{attrs:{maxlength:100},model:{value:t.editForm.accountNumber,callback:function(e){t.$set(t.editForm,"accountNumber","string"===typeof e?e.trim():e)},expression:"editForm.accountNumber"}})],1),r("el-form-item",{attrs:{label:"用户名",prop:"accountName"}},[r("el-input",{attrs:{maxlength:100},model:{value:t.editForm.accountName,callback:function(e){t.$set(t.editForm,"accountName","string"===typeof e?e.trim():e)},expression:"editForm.accountName"}})],1),t.editForm.id?t._e():[r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:t.editForm.password,callback:function(e){t.$set(t.editForm,"password",e)},expression:"editForm.password"}})],1),r("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:t.editForm.checkPass,callback:function(e){t.$set(t.editForm,"checkPass",e)},expression:"editForm.checkPass"}})],1)],r("el-form-item",{attrs:{label:"所属组织",prop:"orgId"}},[r("OrgPicker",{attrs:{adapter:t.orgAdapter},on:{change:function(e){return t.$refs.editForm.validateField("orgId")}},model:{value:t.editForm.orgId,callback:function(e){t.$set(t.editForm,"orgId",e)},expression:"editForm.orgId"}})],1),r("el-form-item",{attrs:{label:"角色"}},[r("el-checkbox-group",{model:{value:t.editForm.roles,callback:function(e){t.$set(t.editForm,"roles",e)},expression:"editForm.roles"}},t._l(t.rolesList,(function(e){return r("el-checkbox",{key:"role"+e.id,attrs:{label:e.id}},[t._v(t._s(e.name))])})),1)],1),r("el-form-item",{attrs:{label:"状态"}},[r("el-switch",{attrs:{"active-text":"启用","inactive-text":"禁用","active-value":1,"inactive-value":0},model:{value:t.editForm.state,callback:function(e){t.$set(t.editForm,"state",e)},expression:"editForm.state"}})],1)],2),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确 定")]),r("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)],1)],1)},n=[],i=r("c7b2"),c=function(t){return i["d"].get("/account/s",{params:t})},l=function(t){return i["d"].get("/account",{params:t})},s=function(t){return i["d"].post("/account",t)},u=function(t){return i["d"].put("/account",t)},d=function(t){return i["d"].delete("/account",{params:t})},m=function(t){return i["d"].put("/account/reset",t)},f=r("ff47"),p={components:{OrgPicker:function(t){return r.e("chunk-1dfc9c8e").then(function(){var e=[r("152a")];t.apply(null,e)}.bind(this)).catch(r.oe)}},data:function(){var t=this,e=function(e,r,a){r?(""!==t.editForm.checkPass&&t.$refs.editForm.validateField("checkPass"),a()):a(new Error("请输入密码"))},r=function(e,r,a){r?r!==t.editForm.password?a(new Error("两次输入密码不一致!")):a():a(new Error("请再次输入密码"))};return{account:a,dialogVisible:!1,loading:!1,list:[],editForm:{id:"",accountNumber:"",accountName:"",password:"",roles:[],state:1},queryParam:{pageSize:10,p:1},totalCount:0,totalPage:0,rules:{accountNumber:[{required:!0,message:"请输入账号",trigger:"blur"}],accountName:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{validator:e,trigger:"blur"}],checkPass:[{validator:r,trigger:"blur"}],orgId:[{required:!0,message:"请选择所属组织"}]},rolesList:[]}},methods:{orgAdapter:function(t,e){return console.log(t,e),e&&e.id?e.fullName:this.editForm.belongOrgFullName?this.editForm.belongOrgFullName:t},handleCurrentChange:function(t){this.queryParam.p=t,this.fetchData()},resetPassword:function(t){var e=this;if(!t)return null;this.$confirm("确定重置账号 ".concat(t.accountNumber," 的密码?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,m({id:t.id}).then((function(){e.fetchData(),e.$alert("密码已重置！",{confirmButtonText:"我知道了"})})).catch((function(){e.loading=!1}))}))},edit:function(t){var e=Object.assign({},t);e.roles=Array.isArray(e.roles)?e.roles.map((function(t){return t.roleId})):[],this.editForm=e,this.dialogVisible=!0},save:function(){var t=this;this.$refs["editForm"].validate((function(e){if(e){t.loading=!0;var r=i["f"].deepcopy(t.editForm);t.handleCloseDialog();var a=r.id?u:s;a(r).then((function(){t.fetchData(),t.$message({message:"添加成功",type:"success"})})).catch((function(){t.loading=!1}))}}))},handleCloseDialog:function(){this.dialogVisible=!1,this.editForm={id:"",accountNumber:"",accountName:"",password:"",roles:[],state:1},this.$refs.editForm&&this.$refs.editForm.resetFields()},remove:function(t){var e=this;if(!t)return null;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.loading=!0,d({id:t.id}).then((function(){e.fetchData(),e.$message({message:"删除成功",type:"success"})})).catch((function(){e.loading=!1}))}))},fetchData:function(t){var e=this;t&&(this.queryParam.p=1),this.loading=!0,c(this.queryParam).then((function(t){e.loading=!1;var r=t.data.data;r&&(e.list=r.list,e.totalCount=r.totalCount,e.totalPage=r.totalPage)})).catch((function(){e.loading=!1}))},fetchRoles:function(){var t=this;Object(f["list"])().then((function(e){t.rolesList=e.data.data}))}},created:function(){this.fetchData(),this.fetchRoles()}},g=p,h=r("2877"),v=Object(h["a"])(g,o,n,!1,null,"46009d86",null);e["default"]=v.exports}}]);