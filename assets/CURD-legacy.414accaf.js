!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */n=function(){return e};var e={},r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(k){u=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var i=e&&e.prototype instanceof h?e:h,o=Object.create(i.prototype),a=new L(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return S()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var c=F(a,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=f(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(t,n,a),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(k){return{type:"throw",arg:k}}}e.wrap=s;var d={};function h(){}function p(){}function m(){}var y={};u(y,a,(function(){return this}));var g=Object.getPrototypeOf,v=g&&g(g(O([])));v&&v!==r&&i.call(v,a)&&(y=v);var b=m.prototype=h.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function x(e,n){function r(o,a,c,l){var u=f(e[o],e,a);if("throw"!==u.type){var s=u.arg,d=s.value;return d&&"object"==t(d)&&i.call(d,"__await")?n.resolve(d.__await).then((function(t){r("next",t,c,l)}),(function(t){r("throw",t,c,l)})):n.resolve(d).then((function(t){s.value=t,c(s)}),(function(t){return r("throw",t,c,l)}))}l(u.arg)}var o;this._invoke=function(t,e){function i(){return new n((function(n,i){r(t,e,n,i)}))}return o=o?o.then(i,i):i()}}function F(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,F(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=f(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,d;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function $(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach($,this),this.reset(!0)}function O(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(i.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=m,u(b,"constructor",m),u(m,"constructor",p),p.displayName=u(m,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,l,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},w(x.prototype),u(x.prototype,c,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new x(s(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(b),u(b,l,"Generator"),u(b,a,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=O,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;j(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:O(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function r(t,e,n,r,i,o,a){try{var c=t[o](a),l=c.value}catch(u){return void n(u)}c.done?e(l):Promise.resolve(l).then(r,i)}var i=document.createElement("style");i.innerHTML="",document.head.appendChild(i),System.register(["./index-legacy.edb0f0bc.js","./ui-legacy.748ef965.js"],(function(t,i){"use strict";var o,a,c,l;return{setters:[function(t){o=t.n,a=t._,c=t.d,l=t.b},function(){}],execute:function(){var u,s,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-table",t._b({ref:"table",attrs:{data:t.list},on:{select:function(e,n){return t.$emit("select",e,n)},"select-all":function(e){return t.$emit("select-all",e)},"selection-change":function(e){return t.$emit("selection-change",e)},"cell-mouse-enter":function(e,n,r,i){return t.$emit("cell-mouse-enter",e,n,r,i)},"cell-mouse-leave":function(e,n,r,i){return t.$emit("cell-mouse-leave",e,n,r,i)},"cell-click":function(e,n,r,i){return t.$emit("cell-click",e,n,r,i)},"cell-dblclick":function(e,n,r,i){return t.$emit("cell-dblclick",e,n,r,i)},"row-click":function(e,n,r){return t.$emit("row-click",e,n,r)},"row-contextmenu":function(e,n,r){return t.$emit("row-click",e,n,r)},"row-dblclick":function(e,n,r){return t.$emit("row-dblclick",e,n,r)},"header-click":function(e,n){return t.$emit("header-click",e,n)},"header-contextmenu":function(e,n){return t.$emit("header-contextmenu",e,n)},"sort-change":function(e,n,r){return t.$emit("sort-change",e,n,r)},"filter-change":function(e){return t.$emit("filter-change",e)},"current-change":function(e,n){return t.$emit("current-change",e,n)},"header-dragend":function(e,n,r,i){return t.$emit("header-dragend",e,n,r,i)},"expand-change":function(e,n){return t.$emit("expand-change",e,n)}}},"el-table",Object.assign({border:!0,"default-expand-all":!0,"row-key":"id"},t.tableAttribute),!1),[n("template",{slot:"append"},[t._t("append")],2),t.selectionNode&&"selection"===t.selectionNode.type?n("el-table-column",t._b({},"el-table-column",t.selectionNode,!1)):t._e(),t._l(t.columnsData,(function(e,r){return n("CURDColumn",{key:"col"+r,attrs:{column:e},scopedSlots:t._u([t._l(Object.keys(t.$scopedSlots),(function(e){return{key:e,fn:function(n){return[t._t(e,null,{column:n.column,row:n.row,prop:n.prop})]}}}))],null,!0)})}))],2),t.showPagination?n("Pagination",{attrs:{"page-size":t.queryParamFinnal.pageSize,"current-page":t.queryParamFinnal.p,"total-count":t.totalCount,"total-page":t.totalPage},on:{"current-change":t.handleCurrentChange}}):t._e(),n("el-dialog",t._b({attrs:{visible:t.dialogVisible},on:{close:t.handleCloseDialog}},"el-dialog",Object.assign({title:"详情",width:"800px","close-on-click-modal":!1,"append-to-body":!0},t.dialogAttribute),!1),[t.dialogVisible?n("CURDForm",{ref:"editForm",attrs:{model:t.modelData,default:t.editForm,action:t.editScope,formAttribute:t.formAttribute}}):t._e(),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确 定")]),n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)],1)],1)},d=[],h={props:{api:{type:Object,required:!0},model:{type:Object,required:!0,default:function(){return{name:{type:"string",default:null,label:"用户名",control:"el-input",controlOption:{},scope:["create","update"],required:!1,validator:null,message:null,asynValid:!1}}}},columns:{type:Array,required:!0,default:function(){return[{hidden:!1,slotName:""}]}},dataKey:{type:String,required:!1,default:"id"},immediate:{type:Boolean,required:!1,default:!0},queryParam:{type:Object,required:!1,default:function(){return{}}},getItemFromDetaiApi:{type:Boolean,required:!1,default:!1},tableAttribute:{type:Object,required:!1,default:function(){return{}}},dialogAttribute:{type:Object,required:!1,default:function(){return{}}},formAttribute:{type:Object,required:!1,default:function(){return{}}}},filters:{formatterFilter:function(t,e,n,r,i){return"function"==typeof i?i(e,n,t,r):t}},components:{CURDForm:function(){return a((function(){return i.import("./CURDForm-legacy.4996a04b.js")}),void 0)},CURDColumn:function(){return a((function(){return i.import("./CURDColumn-legacy.6c7ff1db.js")}),void 0)}},data:function(){var t=this;return{dialogVisible:!1,loading:!1,list:[],editForm:{},editScope:"",queryParamFinnal:{p:1,pageSize:10},totalCount:0,totalPage:0,selectionNode:null,table:{clearSelection:function(){return t.$refs.table.clearSelection()},toggleRowSelection:function(e,n){return t.$refs.table.toggleRowSelection(e,n)},toggleAllSelection:function(){return t.$refs.table.toggleAllSelection()},toggleRowExpansion:function(e,n){return t.$refs.table.toggleRowExpansion(e,n)},setCurrentRow:function(e){return t.$refs.table.setCurrentRow(e)},clearSort:function(){return t.$refs.table.clearSort()},clearFilter:function(e){return t.$refs.table.clearFilter(e)},doLayout:function(){return t.$refs.table.doLayout()},sort:function(e,n){return t.$refs.table.clearFilter(e,n)}},form:{validate:function(e){return t.$refs.editForm.validate(e)},validateField:function(e,n){return t.$refs.editForm.validateField(e,n)},resetFields:function(){return t.$refs.editForm.resetFields()},clearValidate:function(){return t.$refs.editForm.clearValidate()}}}},computed:{showPagination:function(){return this.list.length&&this.totalCount&&this.totalPage},modelKey:function(){return Object.keys(this.model)},modelData:function(){var t=Object.assign({},this.model);return this.modelKey.forEach((function(e){var n=Object.assign({},t[e]);t[e]=Object.assign({type:"string",default:{array:[],object:{}}[n.type]||null,control:{boolean:"el-switch",array:"DictCheckbox"}[n.type]||"el-input",scope:["create","update"],required:!!n.required},n),"el-input"===n.control&&(n.controlOption=Object.assign({maxlength:100},n.controlOption))})),t},modelValue:function(){var t=this,e={};return this.modelKey.map((function(n){e[n]=t.modelData[n].default})),e},columnsData:function(){var t=this;return this.columns.filter((function(e){return"selection"===e.type?(t.selectionNode=Object.assign({},e),!1):!e.hidden})).map((function(t){var e=Object.assign({align:"center"},t);return"selection"!==e.type&&"expand"!==e.type||console.warn('BaseCURD组件：columns=>type属性只支持"default"和"index"'),e}))}},watch:{loading:function(){this.$emit("loading-state",this.loading)}},methods:{handleCurrentChange:function(t){this.queryParamFinnal.p=t,this.fetchList()},create:function(){this.editForm=Object.assign({},this.modelValue),this.editScope="create",this.dialogVisible=!0},update:(u=n().mark((function t(e){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.getItemFromDetaiApi){t.next=4;break}t.t0=c(e),t.next=7;break;case 4:return t.next=6,this.fetchDetail(e[this.dataKey]);case 6:t.t0=t.sent;case 7:this.editForm=t.t0,this.editScope="update",this.dialogVisible=!0;case 10:case"end":return t.stop()}}),t,this)})),s=function(){var t=this,e=arguments;return new Promise((function(n,i){var o=u.apply(t,e);function a(t){r(o,n,i,a,c,"next",t)}function c(t){r(o,n,i,a,c,"throw",t)}a(void 0)}))},function(t){return s.apply(this,arguments)}),save:function(){var t=this;this.$refs.editForm.validate((function(e){if(e){var n=c(t.editForm);t.handleCloseDialog();var r=t.api[t.editScope];if("function"!=typeof r)return console.warn("api.".concat(t.editScope,"()未定义"));t.loading=!0,r(n).then((function(e){200===e.status?(t.$message({message:"操作成功",type:"success"}),t.fetchList()):t.$message({message:"操作失败",type:"warning"})})).catch((function(){t.loading=!1}))}}))},delete:function(t){var n=this;if(!t||!t[this.dataKey])return console.warn("api.delete(): 参数".concat(this.dataKey,"无效"));this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.loading=!0,n.api.delete(e({},n.dataKey,t[n.dataKey])).then((function(t){200===t.status?(n.fetchList(),n.$message({message:"删除成功",type:"success"})):n.$message({message:"删除失败",type:"warning"})})).catch((function(){n.loading=!1}))})).catch((function(){}))},handleCloseDialog:function(){this.dialogVisible=!1,this.editForm=Object.assign({},this.modelValue)},fetchDetail:function(t){var n=this;return t?(this.loading=!0,this.api.detail(e({},this.dataKey,t)).then((function(t){return n.loading=!1,t.data})).catch((function(){n.loading=!1}))):console.warn("api.detail(): 参数".concat(this.dataKey,"无效"))},fetchList:function(t){var e=this;t&&(this.queryParamFinnal.p=1),this.loading=!0,this.api.list(this.queryParamFinnal).then((function(t){e.loading=!1;var n=t.data;Array.isArray(n)?e.list=l(n):Array.isArray(n.list)&&(e.list=l(n.list),e.totalCount=n.totalCount,e.totalPage=n.totalPage)})).catch((function(){e.loading=!1}))},search:function(){Object.assign(this.queryParamFinnal,this.queryParam,{p:this.queryParamFinnal.p,pageSize:this.queryParamFinnal.pageSize}),this.fetchList(!0)}},created:function(){var t=this,e=["list","detail","create","update","delete"].filter((function(e){return"function"!=typeof t.api[e]}));e.length&&console.warn("".concat(e.map((function(t){return"api."+t+"()"})).join("、"),"未定义")),this.immediate&&this.search()}},p={},m=o(h,f,d,!1,y,"165a0364",null,null);function y(t){for(var e in p)this[e]=p[e]}t("default",function(){return m.exports}())}}}))}();
