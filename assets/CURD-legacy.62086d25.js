!function(){function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t(e,t,n,i,r,a,o){try{var l=e[a](o),c=l.value}catch(u){return void n(u)}l.done?t(c):Promise.resolve(c).then(i,r)}var n=document.createElement("style");n.innerHTML="",document.head.appendChild(n),System.register(["./index-legacy.d5061218.js","./ui-legacy.d1d9d8b1.js"],(function(n,i){"use strict";var r,a,o,l;return{setters:[function(e){r=e.n,a=e._,o=e.d,l=e.b},function(){}],execute:function(){var c,u,s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-table",e._b({ref:"table",attrs:{data:e.list},on:{select:function(t,n){return e.$emit("select",t,n)},"select-all":function(t){return e.$emit("select-all",t)},"selection-change":function(t){return e.$emit("selection-change",t)},"cell-mouse-enter":function(t,n,i,r){return e.$emit("cell-mouse-enter",t,n,i,r)},"cell-mouse-leave":function(t,n,i,r){return e.$emit("cell-mouse-leave",t,n,i,r)},"cell-click":function(t,n,i,r){return e.$emit("cell-click",t,n,i,r)},"cell-dblclick":function(t,n,i,r){return e.$emit("cell-dblclick",t,n,i,r)},"row-click":function(t,n,i){return e.$emit("row-click",t,n,i)},"row-contextmenu":function(t,n,i){return e.$emit("row-click",t,n,i)},"row-dblclick":function(t,n,i){return e.$emit("row-dblclick",t,n,i)},"header-click":function(t,n){return e.$emit("header-click",t,n)},"header-contextmenu":function(t,n){return e.$emit("header-contextmenu",t,n)},"sort-change":function(t,n,i){return e.$emit("sort-change",t,n,i)},"filter-change":function(t){return e.$emit("filter-change",t)},"current-change":function(t,n){return e.$emit("current-change",t,n)},"header-dragend":function(t,n,i,r){return e.$emit("header-dragend",t,n,i,r)},"expand-change":function(t,n){return e.$emit("expand-change",t,n)}}},"el-table",Object.assign({border:!0,"default-expand-all":!0,"row-key":"id"},e.tableAttribute),!1),[n("template",{slot:"append"},[e._t("append")],2),e.selectionNode&&"selection"===e.selectionNode.type?n("el-table-column",e._b({},"el-table-column",e.selectionNode,!1)):e._e(),e._l(e.columnsData,(function(t,i){return n("CURDColumn",{key:"col"+i,attrs:{column:t},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots),(function(t){return{key:t,fn:function(n){return[e._t(t,null,{column:n.column,row:n.row,prop:n.prop})]}}}))],null,!0)})}))],2),e.showPagination?n("Pagination",{attrs:{"page-size":e.queryParamFinnal.pageSize,"current-page":e.queryParamFinnal.p,"total-count":e.totalCount,"total-page":e.totalPage},on:{"current-change":e.handleCurrentChange}}):e._e(),n("el-dialog",e._b({attrs:{visible:e.dialogVisible},on:{close:e.handleCloseDialog}},"el-dialog",Object.assign({title:"详情",width:"800px","close-on-click-modal":!1,"append-to-body":!0},e.dialogAttribute),!1),[e.dialogVisible?n("CURDForm",{ref:"editForm",attrs:{model:e.modelData,default:e.editForm,action:e.editScope,formAttribute:e.formAttribute}}):e._e(),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")]),n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1)],1)],1)},d=[],f={props:{api:{type:Object,required:!0},model:{type:Object,required:!0,default:function(){return{accountName:{type:"string",default:null,label:"用户名",control:"el-input",controlOption:{},scope:["create","update"],required:!1,validator:null,message:null,asynValid:!1}}}},columns:{type:Array,required:!0,default:function(){return[{hidden:!1,slotName:""}]}},dataKey:{type:String,required:!1,default:"id"},immediate:{type:Boolean,required:!1,default:!0},queryParam:{type:Object,required:!1,default:function(){return{}}},getItemFromDetaiApi:{type:Boolean,required:!1,default:!1},tableAttribute:{type:Object,required:!1,default:function(){return{}}},dialogAttribute:{type:Object,required:!1,default:function(){return{}}},formAttribute:{type:Object,required:!1,default:function(){return{}}}},filters:{formatterFilter:function(e,t,n,i,r){return"function"==typeof r?r(t,n,e,i):e}},components:{CURDForm:function(){return a((function(){return i.import("./CURDForm-legacy.98725e0f.js")}),void 0)},CURDColumn:function(){return a((function(){return i.import("./CURDColumn-legacy.3c127f36.js")}),void 0)}},data:function(){var e=this;return{dialogVisible:!1,loading:!1,list:[],editForm:{},editScope:"",queryParamFinnal:{p:1,pageSize:10},totalCount:0,totalPage:0,selectionNode:null,table:{clearSelection:function(){return e.$refs.table.clearSelection()},toggleRowSelection:function(t,n){return e.$refs.table.toggleRowSelection(t,n)},toggleAllSelection:function(){return e.$refs.table.toggleAllSelection()},toggleRowExpansion:function(t,n){return e.$refs.table.toggleRowExpansion(t,n)},setCurrentRow:function(t){return e.$refs.table.setCurrentRow(t)},clearSort:function(){return e.$refs.table.clearSort()},clearFilter:function(t){return e.$refs.table.clearFilter(t)},doLayout:function(){return e.$refs.table.doLayout()},sort:function(t,n){return e.$refs.table.clearFilter(t,n)}},form:{validate:function(t){return e.$refs.editForm.validate(t)},validateField:function(t,n){return e.$refs.editForm.validateField(t,n)},resetFields:function(){return e.$refs.editForm.resetFields()},clearValidate:function(){return e.$refs.editForm.clearValidate()}}}},computed:{showPagination:function(){return this.list.length&&this.totalCount&&this.totalPage},modelKey:function(){return Object.keys(this.model)},modelData:function(){var e=Object.assign({},this.model);return this.modelKey.forEach((function(t){var n=Object.assign({},e[t]);e[t]=Object.assign({type:"string",default:{array:[],object:{}}[n.type]||null,control:{boolean:"el-switch",array:"DictCheckbox"}[n.type]||"el-input",scope:["create","update"],required:!!n.required},n),"el-input"===n.control&&(n.controlOption=Object.assign({maxlength:100},n.controlOption))})),e},modelValue:function(){var e=this,t={};return this.modelKey.map((function(n){t[n]=e.modelData[n].default})),t},columnsData:function(){var e=this;return this.columns.filter((function(t){return"selection"===t.type?(e.selectionNode=Object.assign({},t),!1):!t.hidden})).map((function(e){var t=Object.assign({align:"center"},e);return"selection"!==t.type&&"expand"!==t.type||console.warn('BaseCURD组件：columns=>type属性只支持"default"和"index"'),t}))}},watch:{loading:function(){this.$emit("loading-state",this.loading)}},methods:{handleCurrentChange:function(e){this.queryParamFinnal.p=e,this.fetchList()},create:function(){this.editForm=Object.assign({},this.modelValue),this.editScope="create",this.dialogVisible=!0},update:(c=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.getItemFromDetaiApi){e.next=4;break}e.t0=o(t),e.next=7;break;case 4:return e.next=6,this.fetchDetail(t[this.dataKey]);case 6:e.t0=e.sent;case 7:this.editForm=e.t0,this.editScope="update",this.dialogVisible=!0;case 10:case"end":return e.stop()}}),e,this)})),u=function(){var e=this,n=arguments;return new Promise((function(i,r){var a=c.apply(e,n);function o(e){t(a,i,r,o,l,"next",e)}function l(e){t(a,i,r,o,l,"throw",e)}o(void 0)}))},function(e){return u.apply(this,arguments)}),save:function(){var e=this;this.$refs.editForm.validate((function(t){if(t){var n=o(e.editForm);e.handleCloseDialog();var i=e.api[e.editScope];if("function"!=typeof i)return console.warn("api.".concat(e.editScope,"()未定义"));e.loading=!0,i(n).then((function(t){200===t.status?(e.$message({message:"操作成功",type:"success"}),e.fetchList()):e.$message({message:"操作失败",type:"warning"})})).catch((function(){e.loading=!1}))}}))},delete:function(t){var n=this;if(!t||!t[this.dataKey])return console.warn("api.delete(): 参数".concat(this.dataKey,"无效"));this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.loading=!0,n.api.delete(e({},n.dataKey,t[n.dataKey])).then((function(e){200===e.status?(n.fetchList(),n.$message({message:"删除成功",type:"success"})):n.$message({message:"删除失败",type:"warning"})})).catch((function(){n.loading=!1}))})).catch((function(){}))},handleCloseDialog:function(){this.dialogVisible=!1,this.editForm=Object.assign({},this.modelValue)},fetchDetail:function(t){var n=this;return t?(this.loading=!0,this.api.detail(e({},this.dataKey,t)).then((function(e){return n.loading=!1,e.data})).catch((function(){n.loading=!1}))):console.warn("api.detail(): 参数".concat(this.dataKey,"无效"))},fetchList:function(e){var t=this;e&&(this.queryParamFinnal.p=1),this.loading=!0,this.api.list(this.queryParamFinnal).then((function(e){t.loading=!1;var n=e.data;Array.isArray(n)?t.list=l(n):Array.isArray(n.list)&&(t.list=l(n.list),t.totalCount=n.totalCount,t.totalPage=n.totalPage)})).catch((function(){t.loading=!1}))},search:function(){Object.assign(this.queryParamFinnal,this.queryParam,{p:this.queryParamFinnal.p,pageSize:this.queryParamFinnal.pageSize}),this.fetchList(!0)}},created:function(){var e=this,t=["list","detail","create","update","delete"].filter((function(t){return"function"!=typeof e.api[t]}));t.length&&console.warn("".concat(t.map((function(e){return"api."+e+"()"})).join("、"),"未定义")),this.immediate&&this.search()}},m={},h=r(f,s,d,!1,p,"7d58bfc2",null,null);function p(e){for(var t in m)this[t]=m[t]}n("default",function(){return h.exports}())}}}))}();
